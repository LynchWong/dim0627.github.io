<div class="single">
  <!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="Hugo 0.15-DEV" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel='stylesheet' href='//fonts.googleapis.com/css?family=Open+Sans|Marcellus+SC'>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_dark.min.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://yet.unresolved.xyz//index.xml">

    
    <title>boot2dockerでCannot connect to the Docker daemon - Unresolved</title>
    <meta property='og:title' content="boot2dockerでCannot connect to the Docker daemon - Unresolved">
    <meta property="og:type" content="article">
    

    <meta property="og:url" content="http://yet.unresolved.xyz/blog/2014/12/30/could-not-run-docker-in-mac/">
    
    

  </head>

  <body>

    <header class="site">
      <div class="title"><a href="http://yet.unresolved.xyz/">Unresolved</a></div>
    </header>

    <div class="container site">



  <div class="row">
    <div class="col-sm-9">

      <article class="single" itemscope="itemscope" itemtype="http://schema.org/Article">

        <meta itemprop="mainEntityOfPage"  itemType="https://schema.org/WebPage" content="http://yet.unresolved.xyz/"/>
        <meta itemprop="dateModified" content="2014-12-30T00:00:00&#43;00:00">
        <meta itemprop="headline" content="boot2dockerでCannot connect to the Docker daemon">
        <meta itemprop="description" content="これまでは普通に手で作ったVMのUbuntu上でDockerを触ってたんだけど、なんかあれだしboot2dockerに移行しようかと。 いろい">
        <meta itemprop="url" content="http://yet.unresolved.xyz/blog/2014/12/30/could-not-run-docker-in-mac/">
        <div itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
          <meta itemprop="url" content="http://yet.unresolved.xyz/images/default.jpg" />
          <meta itemprop="width" content="800">
          <meta itemprop="height" content="800">
        </div>
        <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
          <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <meta itemprop="url" content="http://yet.unresolved.xyz/images/logo.jpg">
            <meta itemprop="width" content="100">
            <meta itemprop="height" content="100">
          </div>
          <meta itemprop="name" content="Unresolved">
        </div>
        <div itemprop="author" itemscope itemtype="https://schema.org/Person">
          <meta itemprop="name" content="Daisuke Tsuji">
        </div>

        <div class="image" style="background-image: url(http://yet.unresolved.xyz/images/default.jpg);"></div>

        <header>
          <time itemprop="datePublished" pubdate="pubdate" datetime="2014-12-30T00:00:00&#43;00:00">Tue, Dec 30, 2014</time>
          <h1 class="title">boot2dockerでCannot connect to the Docker daemon</h1>
        </header>

        <div class="article-body" itemprop="articleBody">
          

<p>これまでは普通に手で作ったVMのUbuntu上でDockerを触ってたんだけど、なんかあれだしboot2dockerに移行しようかと。</p>

<p>いろいろやってみようとしたら導入から結構躓いた。</p>

<h2 id="boot2dockerの導入:84c49f689db64d048346ac0ea18a9c93">boot2dockerの導入</h2>

<p><a href="https://docs.docker.com/installation/mac/">Installing Docker on Mac OS X</a>に沿って導入してみる。</p>

<p>あ、本体はインストーラじゃなくて<code>brew install boot2docker</code>で導入してます。</p>

<pre><code class="language-sh">b2d$ boot2docker init
2014/12/29 22:59:08 Downloading boot2docker ISO image...
2014/12/29 22:59:09 Latest release is v1.4.1
2014/12/29 23:00:17 Success: downloaded https://github.com/boot2docker/boot2docker/releases/download/v1.4.1/boot2docker.iso
	to /Users/DaisukeTsuji/.boot2docker/boot2docker.iso
Generating public/private rsa key pair.
Your identification has been saved in /Users/DaisukeTsuji/.ssh/id_boot2docker.
Your public key has been saved in /Users/DaisukeTsuji/.ssh/id_boot2docker.pub.
The key fingerprint is:
36:99:81:cf:0b:bd:77:3b:30:9d:66:70:ad:90:ac:35 DaisukeTsuji@DaisukeTsujis-MacBook-Air.local
The key's randomart image is:
+--[ RSA 2048]----+
|                 |
|       .         |
|      . .. . .   |
|       + +E . .  |
|      . So * o   |
|       o.+o *    |
|        o .=.    |
|         . ...   |
|            ..   |
+-----------------+
2014/12/29 23:00:17 Creating VM boot2docker-vm...
2014/12/29 23:00:17 Apply interim patch to VM boot2docker-vm (https://www.virtualbox.org/ticket/12748)
2014/12/29 23:00:17 Setting NIC #1 to use NAT network...
2014/12/29 23:00:17 Port forwarding [ssh] tcp://127.0.0.1:2022 --&gt; :22
2014/12/29 23:00:17 Port forwarding [docker] tcp://127.0.0.1:2375 --&gt; :2375
2014/12/29 23:00:18 Setting NIC #2 to use host-only network &quot;vboxnet1&quot;...
2014/12/29 23:00:18 Setting VM storage...
2014/12/29 23:00:28 Done. Type `boot2docker up` to start the VM.
b2d$ boot2docker status
poweroff
</code></pre>

<p>あとは<code>start</code>すれば使えるのかなと思ったらエラー。</p>

<pre><code class="language-sh">b2d$  boot2docker start
2014/12/30 20:56:21 Waiting for VM to be started...
.......
2014/12/30 20:56:43 Started.
2014/12/30 20:56:43 To connect the Docker client to the Docker daemon, please set:
2014/12/30 20:56:43     export DOCKER_HOST=tcp://192.168.59.103:2375
b2d$ docker run hello-world
2014/12/30 20:51:16 Post http:///var/run/docker.sock/v1.13/containers/create: dial unix /var/run/docker.sock: no such file or directory
</code></pre>

<p>環境変数<code>$DOCKER_HOST</code>に<code>tcp://192.168.59.103:2357</code>が設定されてなきゃいけなかったっぽい。</p>

<p>これによってboot2dockerで起動したVM中のdockerと接続してるのかな。と思ったら、</p>

<pre><code class="language-sh">b2d$ export DOCKER_HOST=tcp://192.168.59.103:2375
b2d$ docker run hello-world
2014/12/30 20:58:41 Cannot connect to the Docker daemon. Is 'docker -d' running on this host?
</code></pre>

<p>環境変数を設定してみるもまたエラー。デーモンと接続できない。</p>

<p>1時間ほど詰まりましたが最悪な原因でした。</p>

<pre><code class="language-sh">b2d$ brew update
b2d$ brew upgrade docker
b2d$ brew upgrade boot2docker
b2d$ boot2docker delete
b2d$ boot2docker init
b2d$ boot2docker up
b2d$ docker version
Client version: 1.4.1
Client API version: 1.16
Go version (client): go1.4
Git commit (client): 5bc2ff8
OS/Arch (client): darwin/amd64
Server version: 1.4.1
Server API version: 1.16
Go version (server): go1.3.3
Git commit (server): 5bc2ff8
b2d$ docker run hello-world
Unable to find image 'hello-world:latest' locally
hello-world:latest: The image you are pulling has been verified
511136ea3c5a: Pull complete
7fa0dcdc88de: Pull complete
ef872312fe1b: Pull complete
Status: Downloaded newer image for hello-world:latest
Hello from Docker.
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
    (Assuming it was not already locally available.)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

For more examples and ideas, visit:
 http://docs.docker.com/userguide/
</code></pre>

<p>パッケージが古かった・・・。</p>

<h2 id="参考にさせて頂きました:84c49f689db64d048346ac0ea18a9c93">参考にさせて頂きました</h2>

<p><a href="https://github.com/boot2docker/osx-installer/issues/80">Cannot connect to the Docker daemon · Issue #80 · boot2docker/osx-installer</a></p>

<p><a href="http://viget.com/extend/how-to-use-docker-on-os-x-the-missing-guide">How to Use Docker on OS X: The Missing Guide | Viget</a></p>

<p><a href="http://qiita.com/uchihara/items/d1b1885866949b63f7dc">Dockerについて調べてみたのでめもめも - Qiita</a></p>

<p><a href="http://inokara.hateblo.jp/entry/2013/09/30/234806">docker API を使ってみる - ようへいの日々精進 XP</a></p>

<p><a href="http://qiita.com/kanekoa/items/cf3cabb23da69c609002">OS X をサポートした Docker 0.8 を試す - Qiita</a></p>

        </div>


        <aside>
          <div class="section"><a href="http://yet.unresolved.xyz/tags/docker" class="tag">docker</a> <a href="http://yet.unresolved.xyz/tags/boot2docker" class="tag">boot2docker</a> </div>

          <div class="section share">
            <a href="http://www.facebook.com/sharer.php?src=bm&u=http%3a%2f%2fyet.unresolved.xyz%2fblog%2f2014%2f12%2f30%2fcould-not-run-docker-in-mac%2f&t=boot2docker%e3%81%a7Cannot%20connect%20to%20the%20Docker%20daemon" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-facebook"></i></a>
            <a href="http://twitter.com/intent/tweet?url=http%3a%2f%2fyet.unresolved.xyz%2fblog%2f2014%2f12%2f30%2fcould-not-run-docker-in-mac%2f&text=boot2docker%e3%81%a7Cannot%20connect%20to%20the%20Docker%20daemon&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a href="https://plus.google.com/share?url=http%3a%2f%2fyet.unresolved.xyz%2fblog%2f2014%2f12%2f30%2fcould-not-run-docker-in-mac%2f" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-google-plus"></i></a>
            <a href="http://getpocket.com/edit?url=http%3a%2f%2fyet.unresolved.xyz%2fblog%2f2014%2f12%2f30%2fcould-not-run-docker-in-mac%2f&title=boot2docker%e3%81%a7Cannot%20connect%20to%20the%20Docker%20daemon" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-get-pocket"></i></a>
          </div>

          
          
          
        </aside>

      </article>
    </div>

    <div class="col-sm-3">
      <aside class="site">

  
  <div class="section">
    <header><div class="title">TableOfContents</div></header>
    <div class="list-default"><nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#boot2dockerの導入:84c49f689db64d048346ac0ea18a9c93">boot2dockerの導入</a></li>
<li><a href="#参考にさせて頂きました:84c49f689db64d048346ac0ea18a9c93">参考にさせて頂きました</a></li>
</ul></li>
</ul>
</nav></div>
  </div>
  

  

  <div class="section">
    <header><div class="title">LatestPosts</div></header>
    <div class="content">
      
      <div class="sm"><article class="li">
  <a href="http://yet.unresolved.xyz/blog/2016/01/02/played-gravity-daze/" class="clearfix">
    <div class="image" style="background-image: url(http://yet.unresolved.xyz//images/gravity-daze.jpg);"></div>
    <div class="detail">
      <time>Sat, Jan 2, 2016</time>
      <h2 class="title">「GRAVITY DAZE」をやった</h2>
      <div class="summary">GRAVITY DAZE 重力的眩暈:上層への帰還において、彼女の内宇宙に生じた摂動 dazeは「夢中」って意味らしいですね。「重力に夢中」って感じの意味でしょうか</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://yet.unresolved.xyz/blog/2015/12/24/want-to-migrate-to-e-books/" class="clearfix">
    <div class="image" style="background-image: url(http://yet.unresolved.xyz//images/default.jpg);"></div>
    <div class="detail">
      <time>Thu, Dec 24, 2015</time>
      <h2 class="title">電子書籍に移行したい</h2>
      <div class="summary">あー、クリスマスですね、クリスマスに日記か・・・、でもせっかく書く気になったし書くよ。 本が邪魔 家の本がすごく邪魔なんだよね、幅を取ってる。 お</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://yet.unresolved.xyz/blog/2015/12/21/played-until-dawn/" class="clearfix">
    <div class="image" style="background-image: url(http://yet.unresolved.xyz//images/until-dawn.png);"></div>
    <div class="detail">
      <time>Mon, Dec 21, 2015</time>
      <h2 class="title">「Until Dawn - 惨劇の山荘」をやった</h2>
      <div class="summary">ホラーっぽかったから避けてたんだけど結局やりました。 とはいえ実際はものすごく面白いサスペンスだったかな。 少しびっくりするシーンとかもあったけ</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://yet.unresolved.xyz/blog/2015/12/17/about-account-killer/" class="clearfix">
    <div class="image" style="background-image: url(http://yet.unresolved.xyz//images/default.jpg);"></div>
    <div class="detail">
      <time>Thu, Dec 17, 2015</time>
      <h2 class="title">ACCOUNT KILLERというサービスが面白い</h2>
      <div class="summary">WordPress.comとGravatarを退会しようと思ったんだけどなんか退会画面が見つからない。 いろいろ調べてみるとこの記事に行き着い</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://yet.unresolved.xyz/blog/2015/12/15/playing-blood-borne/" class="clearfix">
    <div class="image" style="background-image: url(http://yet.unresolved.xyz//images/bloodborne.jpg);"></div>
    <div class="detail">
      <time>Tue, Dec 15, 2015</time>
      <h2 class="title">今更だけどBloodborneをやってる</h2>
      <div class="summary">このブログもようわからんから、日記にしようかな、更新頻度あげたい。 BloodborneのDLCが出たらしいですね、Old Huntersとかい</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://yet.unresolved.xyz/blog/2015/12/11/error-occured-in-structured-data-testing-tool/" class="clearfix">
    <div class="image" style="background-image: url(http://yet.unresolved.xyz//images/default.jpg);"></div>
    <div class="detail">
      <time>Fri, Dec 11, 2015</time>
      <h2 class="title">Googleの構造化データの扱いが変わった気がする</h2>
      <div class="summary">このブログも、他の運営してるサイトも、今日になってエラーが発生するようになった。 Structured Data Testing Tool エラーは2種類発生していて、ひとつめがこれ。 もうひと</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://yet.unresolved.xyz/blog/2015/12/10/using-hugo-in-production/" class="clearfix">
    <div class="image" style="background-image: url(http://yet.unresolved.xyz//images/default.jpg);"></div>
    <div class="detail">
      <time>Thu, Dec 10, 2015</time>
      <h2 class="title">プロダクションのWordPressを捨てHugoに移行した</h2>
      <div class="summary">あんまり仕事のことは書かないつもりだったんだけど、このブログの生成でもお世話になっているHugoを結構本気で使ったのでそのことをまとめてみま</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://yet.unresolved.xyz/blog/2015/11/04/using-https-in-laravel/" class="clearfix">
    <div class="image" style="background-image: url(http://yet.unresolved.xyz//images/default.jpg);"></div>
    <div class="detail">
      <time>Wed, Nov 4, 2015</time>
      <h2 class="title">ELB越しのLaravelでHTTPSを使おうとして困った話</h2>
      <div class="summary">SSL証明書はELBに設置する 何が普通なのか知らないけど、今回立ち上げた構成では CLIENT -&gt; ELB(80 or 443) -&gt; WEB(80) っていう構成にしていました（するつもりだった）</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://yet.unresolved.xyz/blog/2015/10/09/hugo-support-cjk-language/" class="clearfix">
    <div class="image" style="background-image: url(http://yet.unresolved.xyz//images/default.jpg);"></div>
    <div class="detail">
      <time>Fri, Oct 9, 2015</time>
      <h2 class="title">Hugo0.15でSummaryが日本語に対応するっぽい</h2>
      <div class="summary">会社のMacにもHugoをセットアップしてあるんだけど、テーマの編集とかの続きを家でやろうとしたら.Summaryが異なる挙動をしてることに</div>
    </div>
  </a>
</article>
</div>
      
      <div class="sm"><article class="li">
  <a href="http://yet.unresolved.xyz/blog/2015/09/30/using-basic-auth-in-owasp-zap/" class="clearfix">
    <div class="image" style="background-image: url(http://yet.unresolved.xyz//images/default.jpg);"></div>
    <div class="detail">
      <time>Wed, Sep 30, 2015</time>
      <h2 class="title">OWASP ZAPでBASIC認証を突破する</h2>
      <div class="summary">調べても意外と見つからない。 要はリクエストヘッダに認証情報をくっつけられればいいんだけどその方法がわからない。 リクエストヘッダに情報を差し込</div>
    </div>
  </a>
</article>
</div>
      
    </div>
  </div>

  
  <div class="section taxonomies">
    <header><div class="title">tag</div></header>
    <div class="content">
      <a href="http://yet.unresolved.xyz/tags/clojure">clojure</a><a href="http://yet.unresolved.xyz/tags/hugo">hugo</a><a href="http://yet.unresolved.xyz/tags/octopress">octopress</a><a href="http://yet.unresolved.xyz/tags/vim">vim</a><a href="http://yet.unresolved.xyz/tags/php">php</a><a href="http://yet.unresolved.xyz/tags/golang">golang</a><a href="http://yet.unresolved.xyz/tags/linux">linux</a><a href="http://yet.unresolved.xyz/tags/game">game</a><a href="http://yet.unresolved.xyz/tags/vagrant">vagrant</a><a href="http://yet.unresolved.xyz/tags/heroku">heroku</a>
    </div>
  </div>
  

</aside>

    </div>

  </div>

      </div>

    <footer class="site">
      <p>&copy; 2016 Daisuke Tsuji</p>
      <p>Powered by <a href="http://gohugo.io" target="_blank">Hugo</a>,</p>
      <p>Theme <a href="https://github.com/dim0627/hugo_theme_robust" target="_blank">Robust</a> designed by <a href="http://yet.unresolved.xyz" target="_blank">Daisuke Tsuji</a></p>
    </footer>

    <script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-55005303-1', 'auto');
    ga('send', 'pageview');
    </script>
    

  </body>
</html>

</div>
